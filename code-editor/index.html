<!doctype html>
<html lang="en" class="h-100">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css">

    <!-- https://prismjs.com/#basic-usage CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism.css">

    <title>Dima Diplom</title>
  </head>
  <body class="d-flex flex-column h-100">
    
    <header class="container-fluid bg-light">
        <div class="container p-3">
            <div class="d-flex flex-row justify-content-between align-items-center">
                <a href="/" class="h4">PROJECT</a>
    
                <div class="d-flex flex-row align-items-center">
                    <h6 class="mb-0 mr-3">Name Surname</h4>
                    <button type="button" class="btn btn-primary">Logout</button>
                </div>
            </div>
        </div>
        
    </header>

    <main role="main" class="flex-shrink-0">
        <div class="container">
            <div class="row pt-4 pb-6">
                <section class="col-md-3">
                    <div class="card">
                        <div class="card-header">
                            Задания
                        </div>

                        <div class="card-body">
                            <ul class="nav flex-column">
                                <li class="nav-item">
                                    <button type="button" class="btn btn-link" data-toggle="collapse" data-target="#collapseTopic-1" aria-expanded="false" aria-controls="collapseTopic-1">
                                        Тема 1
                                        <i class="bi bi-chevron-bar-expand"></i>
                                    </button>
                                    
                                    <div class="collapse pl-2" id="collapseTopic-1">
                                        <ul class="nav flex-column">
                                            <li class="nav-item">
                                                <a class="nav-link active" href="#">Задание 1.1</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" href="#">Задание 1.2</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" href="#">Задание 1.3</a>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                                
                                <li class="nav-item">
                                    <button type="button" class="btn btn-link" data-toggle="collapse" data-target="#collapseTopic-2" aria-expanded="false" aria-controls="collapseTopic-2">
                                        Тема 2
                                        <i class="bi bi-chevron-bar-expand"></i>
                                    </button>
                                    
                                    <div class="collapse pl-2" id="collapseTopic-2">
                                        <ul class="nav flex-column">
                                            <li class="nav-item">
                                                <a class="nav-link active" href="#">Задание 2.1</a>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </section>
    
                <section class="col-md-9">
                    <article class="container-fluid">
                        <div class="card">
                            <div class="card-header">
                                Название задания
                            </div>
                            <div class="card-body">
                                <div id="taskView"></div>
                            </div>
                        </div>

                        <div class="card mt-4 mb-4">
                            <div class="card-header">
                                Редактор кода
                            </div>
                            <div class="card-body p-0">

                                <div class="input-group">
                                    <select id="languageSelect" class="custom-select">
                                        <option disabled>Язык программирования</option>
                                        <option value="javascript">Javascript</option>
                                        <option selected value="java">Java</option>
                                        <option value="c_cpp">C++</option>
                                    </select>
 
                                    <div class="input-group-append">
                                      <button id="editorButton" class="btn btn-primary" type="button">Запуск</button>
                                    </div>
                                </div>

                                <div id="editor"></div>
                            </div>
                        </div>
                    </article>
                </section>
            </div>
        </div>
    </main>
    
    <div class="modal" tabindex="-1" id="modal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body" id="modal-body">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Ok</button>
          </div>
        </div>
      </div>
    </div>

    <footer class="mt-auto py-3 bg-light">
        <div class="container">
            <span class="text-muted">Footer</span>
        </div>
    </footer>

    <!-- jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>

    <!-- https://marked.js.org -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        const defaultTask = `#### Описание задания\nLorem ipsum dolor sit amet consectetur adipisicing elit. Harum consequuntur nostrum, a ab veniam natus ea magni error quasi pariatur nulla corrupti officia adipisci illum saepe dicta quae consectetur laborum?\n
| Входные данные | Выходные данные |
| ----- | ----- |
| 25 91    |   116   |
        `;

        const taskViewNode = document.getElementById('taskView');
        taskViewNode.innerHTML = marked(defaultTask);
        console.log(marked(defaultTask))
    </script>

    <!-- https://ace.c9.io/  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.5/ace.js" type="text/javascript" charset="utf-8"></script>
    <script>
        const defaultCodeList = new Map()
        defaultCodeList.set('javascript', "const sum = (a, b) => a + b;\n\nconsole.log(sum(25, 91));\n");
        defaultCodeList.set('java', "class Main {\n\n\tpublic static void main(String[] args) {\n\n\t\tint first = 25, second = 91;\n\t\tSystem.out.println(first + second);\n\t}\n}\n");
        defaultCodeList.set('c_cpp', "#include <iostream>\nusing namespace std;\n\nint main()\n{\n\tint firstNumber = 25, secondNumber = 91;\n\n\tcout<<firstNumber + secondNumber;\n\n\treturn 0;\n}\n");

        const editor = ace.edit('editor', {
            theme: 'ace/theme/github',
            mode: 'ace/mode/javascript',
            minLines: 16,
            maxLines: 32,
            wrap: true,
        });
        
        // Set default code into editor
        editor.insert(defaultCodeList.get('java'));

        // Listen to change event and load default code for selected language
        const languageSelectNode = document.getElementById('languageSelect');
        languageSelectNode.addEventListener('change', () => {
            const {value} = languageSelectNode;

            editor.session.setMode(`ace/mode/${value}`);
            editor.setValue('');
            editor.insert(defaultCodeList.get(value));
        });

        const editorButtonNode = document.getElementById('editorButton');
        editorButtonNode.addEventListener('click', () => {
            // get code from editor
            const code = editor.getValue()

            alert(code);
        });
    </script>


    <script>
      // setTimeout = success
      setTimeout(function (data) {

        // if (data.dto) {

        const modalNode = document.getElementById('modal');
        const modalBodyNode = document.getElementById('modal-body');

        const pNode = document.createElement('p');
        pNode.innerText = 'Ваши результаты доступны по ссылке';
        
        const aNode = document.createElement('a');
        aNode.href = 'http://localhost:8080/task/view';
        aNode.target = '_blank';
        aNode.innerText = 'Открой меня полностью'

        modalBodyNode.appendChild(pNode);
        modalBodyNode.appendChild(aNode);

        $('#modal').modal('show')

        // }
      }, 1000)
    </script>
  </body>
</html>
